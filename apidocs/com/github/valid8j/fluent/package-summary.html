<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_412) on Fri Jun 28 07:21:11 JST 2024 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>com.github.valid8j.fluent (valid8j 2.1.3 API)</title>
<meta name="date" content="2024-06-28">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="com.github.valid8j.fluent (valid8j 2.1.3 API)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/github/valid8j/classic/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../../com/github/valid8j/fluent/internals/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/github/valid8j/fluent/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;com.github.valid8j.fluent</h1>
<div class="docSummary">
<div class="block">This package hosts classes for "Fluent" programming model of <code>valid8j</code>.</div>
</div>
<p>See:&nbsp;<a href="#package.description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../com/github/valid8j/fluent/Expectations.Unless.html" title="interface in com.github.valid8j.fluent">Expectations.Unless</a></td>
<td class="colLast">
<div class="block">An interface used as a return value of <a href="../../../../com/github/valid8j/fluent/Expectations.html#fail-java.util.function.Function-"><code>Expectations.fail(Function)</code></a> method.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../com/github/valid8j/fluent/Expectations.CustomTransformer.html" title="class in com.github.valid8j.fluent">Expectations.CustomTransformer</a>&lt;TX extends <a href="../../../../com/github/valid8j/pcond/core/fluent/AbstractObjectTransformer.html" title="interface in com.github.valid8j.pcond.core.fluent">AbstractObjectTransformer</a>&lt;TX,<a href="../../../../com/github/valid8j/pcond/core/fluent/builtins/ObjectChecker.html" title="interface in com.github.valid8j.pcond.core.fluent.builtins">ObjectChecker</a>&lt;T,T&gt;,T,T&gt;,T&gt;</td>
<td class="colLast">
<div class="block">A base class for a custom transformer.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Enum Summary table, listing enums, and an explanation">
<caption><span>Enum Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Enum</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../com/github/valid8j/fluent/Expectations.html" title="enum in com.github.valid8j.fluent">Expectations</a></td>
<td class="colLast">
<div class="block">A facade class for the "fluent" style programming model of <code>valid8j</code> library.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package.description">
<!--   -->
</a>
<h2 title="Package com.github.valid8j.fluent Description">Package com.github.valid8j.fluent Description</h2>
<div class="block"><p>This package hosts classes for "Fluent" programming model of <code>valid8j</code>.</p>
<h2 id="fluent-programming-model">Fluent Programming Model</h2>
<div class="sectionbody">
<p>The first example of the model looks like following.</p>
<div class="listingblock">
<div class="title">Before static import</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">DbC</span> {
  <span class="directive">public</span> <span class="type">void</span> aMethod(<span class="type">int</span> a) {
    <span class="keyword">assert</span> Expectations.precondition(Expectations.that(a).satisfies()
                                                         .greaterThan(<span class="integer">0</span>)
                                                         .lessThan(<span class="integer">100</span>));
  }
}</code></pre>
</div>
</div>
<p>Remember, start from the <code>Expectations</code> class, then let your IDE help you.</p>
<p>Then, do <code>static import</code> to improve readability.</p>
<div class="listingblock">
<div class="title">After static import</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">DbC</span> {
  <span class="directive">public</span> <span class="type">void</span> aMethod(<span class="type">int</span> a) {
    <span class="keyword">assert</span> precondition(that(a).satisfies()
                               .greaterThan(<span class="integer">0</span>)
                               .lessThan(<span class="integer">100</span>));
  }
}</code></pre>
</div>
</div>
<p>The difference from the existing "fluent" test libraries such as AssertJ or Google Truth here is:</p>
<div class="ulist">
<ul>
<li>
<p>Your entry point is <code>Expectations</code> class.</p>
</li>
<li>
<p>The methods for evaluating condition (<code>precondition</code>) and the methods to create the condition are separated.</p>
</li>
</ul>
</div>
<p>The second allows us to use the consistent syntax for different contexts such as DbC assertions, test assertions, argument checking, etc.</p>
<h3 id="example-test-assertions">Example: Test assertions</h3>
<p>To build a test assertion, you use <code>Expectations.assertStatement</code> method, if you have only one variable to be checked.</p>
<div class="listingblock">
<div class="title">single statement</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">TestExample</span> {
  <span class="annotation">@Test</span>
  <span class="directive">public</span> <span class="type">void</span> testMethod() {
    assertStatement(that(a).satisfies()
                           .greaterThan(<span class="integer">0</span>)
                           .lessThan(<span class="integer">100</span>));
  }
}</code></pre>
</div>
</div>
<p>However, if you have multiple variables, you need to evaluate multiple statements at once.
If you do it by calling <code>assertStatement</code> multiple times, you will need to look into the failure report, fix it, and run it.
If it works, it may be okay, however, if it fails at the next point, you will need to do the same again.
Even worse, the second fix may introduce another failure at a different position.</p>
<p>To avoid it, use <code>assertAll</code>, which accepts multiple statements at once.</p>
<div class="listingblock">
<div class="title">multiple statements</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">TestExample</span> {
  <span class="annotation">@Test</span>
  <span class="directive">public</span> <span class="type">void</span> testMethod() {
    assertAll(that(a).satisfies()
                     .greaterThan(<span class="integer">0</span>)
                     .lessThan(<span class="integer">0</span>),
              that(s).satisfies()
                     .notNull()
                     .notEmpty());
  }
}</code></pre>
</div>
</div>
<h3 id="example-overhead-free-dbc-assertions">Example: Overhead-free DbC Assertions</h3>
<p>Java has a reserved keyword <code>assert</code>, which throws an <code>AssertionError</code> if its parameter evaluated <code>false</code>, otherwise, it doesn&#8217;t do anything.
Not only that, if a VM parameter <code>-da</code> is given, it completely doesn&#8217;t do anything.
Even evaluation of the parameter doesn&#8217;t happen.
The message of the <code>AssertionError</code> is given as the second parameter of the <code>assert</code> statement.</p>
<div class="listingblock">
<div class="content">
<pre>assert expression: "failed!";</pre>
</div>
</div>
<p>To compose an informative message on a failure, what <code>valid8j</code> does is:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If the statement is evaluated <code>true</code>, it will return <code>true</code>.</p>
</li>
<li>
<p>If <code>false</code>, it will compose an informative message and throw an exception, not returning any value.</p>
</li>
</ol>
</div>
<p>Following is an example for precondition checking.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">OverheadFreeDbC</span> {
  <span class="directive">public</span> <span class="type">void</span> aMethod(<span class="type">int</span> a) {
    <span class="keyword">assert</span> precondition(that(a).satisfies()
                               .greaterThan(<span class="integer">0</span>)
                               .lessThan(<span class="integer">100</span>));
  }
}</code></pre>
</div>
</div>
<p><code>valid8j</code> also has <code>invariant(Statement)</code> and <code>postcondition(Statement)</code> for invariant and postcondition checking respectively.</p>
<p>In case you want to evaluate multiple statements, just use plural versions of theirs, which are <code>preconditions(Statement&#8230;&#8203;)</code>, <code>invariants(Statement&#8230;&#8203;)</code>, and <code>postconditions(Statement&#8230;&#8203;)</code>.</p>
<h3 id="example-enforced-dbc-assertions">Example: Enforced DbC Assertions</h3>
<p>In some situations, you may want to enforce the assertions even in production.
For instance, in financial industry, it may be better to produce an error than creating an inconsistent result.</p>
<p><code>valid8j</code> has another set of methods for it, which are <code>require(Statement&#8230;&#8203;)</code>, <code>hold(Statement&#8230;&#8203;)</code>, and <code>ensure(Statement&#8230;&#8203;)</code>.
They are used for checking preconditions, invariant conditions, and <code>postconditions</code>, respectively.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">EnforcedDbC</span> {
  <span class="directive">public</span> <span class="type">void</span> method(<span class="type">int</span> a) {
    <span class="comment">// precondition</span>
    require(that(a).satisfies()
                   .greaterThan(<span class="integer">0</span>)
                   .lessThan(<span class="integer">100</span>));
    <span class="comment">// invariant condition</span>
    hold(that(a).satisfies()
                .greaterThan(<span class="integer">0</span>)
                .lessThan(<span class="integer">100</span>));
    <span class="comment">// postcondition</span>
    ensure(that(a).satisfies()
                  .greaterThan(<span class="integer">0</span>)
                  .lessThan(<span class="integer">100</span>));
  }
}</code></pre>
</div>
</div>
<h3 id="example-guava-like-value-checking">Example: Guava-like value checking</h3>
<p>Guava has a class called <code>Preconditions</code> that allows us to validate a value as an argument with a given predicate.</p>
<p><code>valid8j</code> can do the same, but in a much more powerful way.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">ValueChecking</span> {
  <span class="directive">public</span> <span class="type">void</span> method(<span class="type">int</span> a) {
    <span class="type">int</span> price = requireArgument(that(a).satisfies()
                                       .greaterThan(<span class="integer">0</span>)
                                       .lessThan(<span class="integer">1</span>_000_000));
    <span class="predefined-type">System</span>.out.println(price);
  }
}</code></pre>
</div>
</div>
<p>The code will generate an appropriate message automatically without repeating what you are doing for the value checking as a string literal.</p>
</div>
<h2 id="formal-definition">Formal Definition</h2>
<div class="sectionbody">
<p>Following is a formal definition for how to construct checking logics using <code>valid8j</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">// Overhead-free DbC assertions
"assert" BOOLEAN_VALIDATOR_CALL_SINGULARS "(" STATEMENT ")"
"assert" BOOLEAN_VALIDATOR_CALL_PLURALS   "(" STATEMENT ("," STATEMENT)* ")"

// Enforced DbC assertions
"Expectations.require"|                                 <b class="conum">(1)</b>
"Expectations.hold"|                                    <b class="conum">(1)</b>
"Expectations.ensure"|                                  <b class="conum">(1)</b>

// Value Checking
"Expectations.requireArguments"
"Expectations.requireArgument"
"Expectations.requireStates"
"Expectations.requireState"

// Test Assertions
"Expectations.assertAll"       "(" STATEMENT ")"
"Expectations.assertStatement" "(" STATEMENT ("," STATEMENT)* ")"

MULTIPLE_STATEMENTS_VALIDATOR_CALL "(" STATEMENT ("," STATEMENT)* ")"

SINGLE_STATEMENT_VALIDATOR_CALL "(" STATEMENT ")"

BOOLEAN_VALIDATOR_CALL_SINGULARS ::=
             "Expectations.$"|
             "Expectations.precondition"|
             "Expectations.invariant"|
             "Expectations.postcondition"

BOOLEAN_VALIDATOR_CALL_PLURALS ::=
             "Expectations.all"|
             "Expectations.preconditions"|
             "Expectations.invariants"|
             "Expectations.postconditions"

MULTIPLE_STATEMENTS_VALIDATOR_CALL ::=
      "Expectations.assertAll"|
      "Expectations.require"|                                <b class="conum">(1)</b>
      "Expectations.hold"|                                   <b class="conum">(1)</b>
      "Expectations.ensure"|                                 <b class="conum">(1)</b>
      "Expectations.requireArguments"|
      "Expectations.requireStates"

SINGLE_STATEMENT_VALIDATOR_CALL ::=
      "Expectations.assertStatement"|
      "Expectations.require"|                                 <b class="conum">(1)</b>
      "Expectations.hold"|                                    <b class="conum">(1)</b>
      "Expectations.ensure"|                                  <b class="conum">(1)</b>
      "Expectations.requireArgument"|
      "Expectations.requireState"

STATEMENT ::=
     ("Expectations.that(T)" TRANSFORMER_METHOD* SATISFIES CHECKER_METHOD+)|
     ("Expectations.satisfies(T)" CHECKER_METHOD+)|
      "Expectations.statement(T, Predicate&lt;T&gt;)"

SATISFIES ::=
  ".then()"|
  ".satisfies()"|
  ".toBe()"

TRANSFORMING_METHOD ::=
     .stringify()|
     .asObject()|
     .expectException|
     .invoke(String,Object...)|
     .invokeStatic(Class&lt;?&gt;,String,Object...)|                <b class="conum">(2)</b>
     ...

CHECKING_METHOD ::=
     .notNull()|
     .equalTo()|
     .sameReferenceAs()|
     .instanceOf(Class&lt;?&gt;)|
     .invoke(String,Object...)|
     .invokeStatic(Class&lt;?&gt;,String,Object...)|                <b class="conum">(3)</b>
     ...</pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>For <code>require</code>, <code>hold</code>, and <code>ensure</code>, methods are overloaded.</p>
</li>
<li>
<p>Depending on the ongoing context, a different set of transforming methods will become available.</p>
</li>
<li>
<p>Depending on the ongoing context, a different set of checking methods will become available.</p>
</li>
</ol>
</div>
</div></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/github/valid8j/classic/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../../com/github/valid8j/fluent/internals/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/github/valid8j/fluent/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2024. All rights reserved.</small></p>
</body>
</html>
